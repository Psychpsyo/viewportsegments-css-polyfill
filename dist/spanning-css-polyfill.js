var e="spanning",n="single-fold-horizontal",t="single-fold-vertical",o="none",r="fold-top",i="fold-left",a="fold-height",d="fold-width",l="__foldables_env_vars__",u="(@media.*?\\b"+e+"\\b[^{]+)\\{([\\s\\S]+?\\})\\s*\\}",c=/\((.*?)\)/gi,f=/@media[^\(]+/gi,s=function(e){return new RegExp("env\\(\\s*"+e+"\\s*\\)","gi")};function h(e,n){return e.replace(new RegExp(u,"gi"),n)}function p(r){var i=function(e){var n,t=new RegExp(u,"gi");if("function"==typeof e.matchAll)n=Array.from(e.matchAll(t));else{for(n=[];n[n.length]=t.exec(e););n.length--}return n}(r),a={};return a[n]="",a[t]="",a[o]="",i.forEach(function(r){var i=r[1],d=r[2],l=o;i.indexOf(n)>-1&&(l=n),i.indexOf(t)>-1&&(l=t);var u=i.match(f)||[],s=i.match(c)||[];s=s.filter(function(n){return!n.includes(e)}).join(" and "),a[l]+="\n      "+u+" "+s+" {\n        "+d+"\n      }"}),a}function w(e,n){var t;return function(){var o=arguments,r=this;clearTimeout(t),t=setTimeout(function(){return e.apply(r,o)},n)}}if(void 0===window[l]){var g=sessionStorage.getItem(l+"-spanning")||o,m=+sessionStorage.getItem(l+"-foldSize")||0,v=+sessionStorage.getItem(l+"-browserShellSize")||0;Object.defineProperty(window,l,{value:{spanning:g,foldSize:m,browserShellSize:v,update:A,onupdate:[x]}}),window.addEventListener("message",function(e){"update"===(e.data.action||"")&&window[l].update(e.data.value||{})})}else window[l].onupdate.push(x);var S,y=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),E={};function b(e,r){var i,a=h(r,""),d=p(r);return E[e]=((i={})[n]="",i[t]="",i[o]="",i),Object.keys(d).forEach(function(n){void 0!==E[e][n]&&(E[e][n]+="\n        /* origin: "+e+" */\n        "+d[n])}),E[e]["non-spanning"]=a,a}function z(e){x(e),window.addEventListener("resize",function(e){return w(function(e){return x(e)},150)}),window[l].onupdate.push(function(){return x(e)})}function x(e){e?Array.from(e.shadowRoot.querySelectorAll("."+l)).forEach(function(e){return e.parentNode.removeChild(e)}):Array.from(document.querySelectorAll("."+l)).forEach(function(e){return e.parentElement.removeChild(e)});var o=window[l],u=e?E[e.nodeName.toLowerCase()][o.spanning]:E[o.spanning],c=e?E[e.nodeName.toLowerCase()]["non-spanning"]:null,f=function(e){var o,l=0,u=0,c=0,f=0;return e.spanning===t&&(c=e.foldSize,f=window.innerHeight,l=window.innerWidth/2-e.foldSize/2),e.spanning===n&&(c=window.innerWidth,f=e.foldSize,u=(window.innerHeight-e.browserShellSize)/2-e.foldSize/2),(o={})[r]=u,o[i]=l,o[a]=f,o[d]=c,o}(o);Object.keys(f).forEach(function(e){var n;n=f[e]+"px",u=u.replace(s(e),n)});var h=document.createElement("style");if(h.className=l,h.textContent=u,e){var p=e.shadowRoot;"adoptedStyleSheets"in p&&p.adoptedStyleSheets.length>0?p.adoptedStyleSheets[0].replace(c+u):p.appendChild(h)}else document.head.appendChild(h)}E[n]="",E[t]="",E[o]="",(S=y,Promise.all(S.map(function(e){var n=e.href;return n?fetch(n).then(function(e){return e.text()}):e.textContent}))).then(function(e){var n=new DocumentFragment;e.forEach(function(e,t){var o,r,i,a=h(e,""),d=p(e),l=y[t].href||"inline";Object.keys(d).forEach(function(e){void 0!==E[e]&&(E[e]+="\n          /* origin:  "+l+" */\n          "+d[e])}),n.appendChild((o={"data-css-origin":l},r=a,i=document.createElement("style"),Object.keys(o).forEach(function(e){i.setAttribute(e,o[e])}),void 0!==r&&(i.textContent=r),i))}),y.forEach(function(e){return e.parentElement.removeChild(e)}),document.head.appendChild(n),x(),window.addEventListener("resize",function(){return w(x,150)})});var C=new Set(["foldSize","browserShellSize","spanning"]);function A(e){Object.keys(e).forEach(function(n){C.has(n)&&(window[l][n]=e[n],sessionStorage.setItem(l+"-"+n,window[l][n]))}),window[l].onupdate.forEach(function(e){return e()})}export{b as adjustCSS,z as observe,A as update};
//# sourceMappingURL=spanning-css-polyfill.js.map
